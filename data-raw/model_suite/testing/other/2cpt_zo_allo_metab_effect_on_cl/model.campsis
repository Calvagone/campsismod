[MAIN]
TVMETAB_CL=THETA_METAB_CL
if (METAB==0) TVMETAB_CL=0
MU_DUR=THETA_DUR
MU_VC=THETA_VC
TVVP=THETA_VP
TVQ=THETA_Q
MU_CL=THETA_CL + TVMETAB_CL
TVPROP_RUV=THETA_PROP_RUV

METAB_CL=exp(TVMETAB_CL)
DUR=exp(MU_DUR + ETA_DUR)
VC=exp(MU_VC + ETA_VC)*pow(WT/70,1)
VP=exp(TVVP)*pow(WT/70,1)
Q=exp(TVQ)*pow(WT/70,0.75)
CL=exp(MU_CL + ETA_CL)*pow(WT/70,0.75)
PROP_RUV=exp(TVPROP_RUV)

[ODE]
d/dt(A_CENTRAL)=Q/VP*A_PERIPHERAL - Q/VC*A_CENTRAL - CL/VC*A_CENTRAL
d/dt(A_PERIPHERAL)=Q/VC*A_CENTRAL - Q/VP*A_PERIPHERAL

[DURATION]
A_CENTRAL=DUR

[ERROR]
CONC=A_CENTRAL/VC
if (CONC <= 0.001) CONC=0.001
IPRED=log(CONC)
W=PROP_RUV
Y=IPRED + W*EPS_RUV_FIX

